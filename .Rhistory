setwd("~/Projects/Project Manufacturing")
library(dplyr)
dtrain = read.csv('bank-full_train.csv',stringsAsFactors = FALSE)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
dtest= read.csv('product_test.csv',stringsAsFactors = FALSE)
View(dtrain)
str(dtest)
sum(is.na(dtrain))
str(dtrain)
sum(is.na(dtrain))
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="yes"))
table(dtrain$potential_issue)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="no"))
table(dtrain$potential_issue)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
dtrain=dtrain%>%
mutate(potentialissue=as.numeric(potential_issue=="yes")) %>%
select(-potential_issue)
table(dtrain$potential_issue)
table(dtrain$potentialissue)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="yes"))
table(dtrain$potential_issue)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="yes"))
table(dtrain$potential_issue)
str(dtrain)
dtrain = read.csv('product_train.csv',stringsAsFactors = FALSE)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
table(dtrain$potential_issue)
library(ROSE)
table(dtrain$went_on_backorder)
dtrain <- ovun.sample(went_on_backorder~., data=train,p=0.5, seed=1,method="over")$data
train = read.csv('product_train.csv',stringsAsFactors = FALSE)
dtest= read.csv('product_test.csv',stringsAsFactors = FALSE)
str(dtrain)
sum(is.na(dtrain))
table(dtrain$went_on_backorder)
dtrain <- ovun.sample(went_on_backorder~., data=train,p=0.5, seed=1,method="over")$data
table(dtrain$went_on_backorder)
table(dtrain$potential_issue)
str(train)
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
table(dtrain$deck_risk)
dtrain=dtrain%>%
mutate(deck_risk=as.numeric(deck_risk=="Yes"))
table(dtrain$oe_constraint)
dtrain=dtrain%>%
mutate(oe_constraint=as.numeric(oe_constraint=="Yes"))
table(dtrain$ppap_risk)
dtrain=dtrain%>%
mutate(ppap_risk=as.numeric(ppap_risk=="Yes"))
table(dtrain$stop_auto_buy)
dtrain=dtrain%>%
mutate(stop_auto_buy=as.numeric(stop_auto_buy=="Yes"))
table(dtrain$rev_stop)
dtrain=dtrain%>%
mutate(rev_stop=as.numeric(rev_stop=="Yes"))
table(dtrain$went_on_backorder)
dtrain=dtrain%>%
mutate(went_on_backorder=as.numeric(went_on_backorder=="Yes"))
sum(is.na(dtrain))
table(dtrain$potential_issue)
table(dtrain$went_on_backorder)
str(train)
boxplot(dtrain$sku)
boxplot(dtrain[1])
boxplot(dtrain[2])
boxplot(dtrain[0])
boxplot(dtrain[3])
boxplot(dtrain[4])
boxplot(dtrain[5])
dtrain[5]
str(train)
str(dtrain)
boxplot(dtrain[6])
boxplot(dtrain[7])
boxplot(dtrain[8])
boxplot(dtrain[9])
boxplot(dtrain[10])
boxplot(dtrain[11])
boxplot(dtrain[12])
boxplot(dtrain[13])
boxplot(dtrain[14])
boxplot(dtrain[15])
boxplot(dtrain[-1])
boxplot(drain$national_inv)
boxplot(dtrain$national_inv)
summary(dtrain$national_inv)
dtrain$national_inv <- ifelse(dtrain$national_inv > ul, ul, dtrain$national_inv)
ul <- 22 + 1.5*(22 - 1)
dtrain$national_inv <- ifelse(dtrain$national_inv > ul, ul, dtrain$national_inv)
boxplot(dataset$age)
boxplot(dtrain$national_inv)
ll <- 1 - 1.5*(22-1)
dtrain$national_inv <- ifelse(dtrain$national_inv < ll, ll, dtrain$national_inv)
boxplot(dtrain$national_inv)
boxplot(dtrain$lead_time)
summary(dtrain$lead_time)
ul <- 8 + 1.5*(8 - 2)
dtrain$lead_time <- ifelse(dtrain$lead_time > ul, ul, dtrain$lead_time)
boxplot(dtrain$lead_time)
boxplot(dtrain$in_transit_qty)
summary(dtrain$in_transit_qty)
boxplot(dtrain$forecast)
summary(dtrain$forecast)
boxplot(dtrain$forecast_3_month)
summary(dtrain$forecast_3_month)
ul <- 24 + 1.5*(24 - 0)
dtrain$forecast_3_month <- ifelse(dtrain$forecast_3_month > ul, ul, dtrain$forecast_3_month)
boxplot(dtrain$forecast_3_month)
boxplot(dtrain$forecast_6_month)
summary(dtrain$forecast_6_month)
ul <- 42 + 1.5*(42 - 0)
dtrain$forecast_6_month <- ifelse(dtrain$forecast_6_month > ul, ul, dtrain$forecast_6_month)
boxplot(dtrain$forecast_6_month)
boxplot(dtrain$forecast_9_month)
summary(dtrain$forecast_9_month)
ul <- 60 + 1.5*(60 - 0)
dtrain$forecast_9_month <- ifelse(dtrain$forecast_9_month > ul, ul, dtrain$forecast_9_month)
boxplot(dtrain$forecast_9_month)
boxplot(dtrain$sales)
boxplot(dtrain$sales_1_month)
summary(dtrain$sales_1_month)
ul <- 7 + 1.5*(7 - 0)
dtrain$sales_1_month <- ifelse(dtrain$sales_1_month > ul, ul, dtrain$sales_1_month)
boxplot(dtrain$sales_1_month)
boxplot(dtrain$sales_3_month)
summary(dtrain$sales_3_month)
ul <- 21 + 1.5*(21 - 0)
dtrain$sales_3_month <- ifelse(dtrain$sales_3_month > ul, ul, dtrain$sales_3_month)
boxplot(dtrain$sales_1_month)
boxplot(dtrain$sales_3_month)
boxplot(dtrain$sales_6_month)
summary(dtrain$sales_6_month)
ul <- 38 + 1.5*(38 - 1)
dtrain$sales_6_month <- ifelse(dtrain$sales_6_month > ul, ul, dtrain$sales_6_month)
boxplot(dtrain$sales_6_month)
boxplot(dtrain$sales_9_month)
summary(dtrain$sales_9_month)
ul <- 55 + 1.5*(55 - 1)
dtrain$sales_9_month <- ifelse(dtrain$sales_9_month > ul, ul, dtrain$sales_9_month)
boxplot(dtrain$sales_9_month)
boxplot(dtrain$min_bank)
summary(dtrain$min_bank)
ul <- 3 + 1.5*(3 - 0)
dtrain$min_bank <- ifelse(dtrain$min_bank > ul, ul, dtrain$min_bank)
boxplot(dtrain$min_bank)
boxplot(dtrain$in_transit_qty)
summary(dtrain$in_transit_qty)
library(car)
for_vif <- lm(went_on_backorder~.
, data = dtrain)
summary(for_vif)
for_vif <- lm(went_on_backorder~.-pieces_past_due
, data = dtrain)
summary(for_vif)
for_vif <- lm(went_on_backorder~.-pieces_past_due, data = dtrain)
summary(for_vif)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~., data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month
-sales_9_month, data = dtrain)
sort(vif(for_vif),decreasing = T)[1:3]
summary(for_vif)
fit=glm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month
-sales_9_month,family= "binomial",data = dtrain)
fit=step(fit)
summary(fit)
formula(fit)
y_pred = predict(fit,newdata=dtrain,type="response")
library(ggplot2)
library(ggplot2)
ggplot(dataset,aes(x=y_pred,y=went_on_backorder,color=factor(y)))+geom_point()+geom_jitter()
ggplot(dtrain,aes(x=y_pred,y=went_on_backorder,color=factor(y)))+geom_point()+geom_jitter()
ggplot(dtrain,aes(x=y_pred,y=went_on_backorder,color=factor(went_on_backorder)))+geom_point()+geom_jitter()
boxplot(dtrain$in_transit_qty)
summary(dtrain$in_transit_qty)
summary(for_vif)
fit=glm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month-pieces_past_due,
family= "binomial",data = dtrain)
fit=step(fit)
summary(fit)
fit=glm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month
-pieces_past_due-oe_constraint,family= "binomial",data = dtrain)
fit=step(fit)
summary(fit)
formula(fit)
y_pred = predict(fit,newdata=dtrain,type="response")
library(ggplot2)
ggplot(dtrain,aes(x=y_pred,y=went_on_backorder,color=factor(went_on_backorder)))+geom_point()+geom_jitter()
library(caret)
ROCRPred <- prediction(y_pred, dtrain$went_on_backorder)
library(ROCR)
ROCRPred <- prediction(y_pred, dtrain$went_on_backorder)
ROCRPerf <- performance(ROCRPred, "tpr", "fpr")
plot(ROCRPerf, colorize=TRUE, print.cutoffs.at=seq(.1, by = 0.1))
abline(a=0, b=1)
res <- predict(fit, dtrain, type = "response")
PredictedValue <- res>.5
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dataset$y <- as.factor(dtrain$went_on_backorder)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
PredictedValue <- res>.4
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
PredictedValue <- res>.6
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
PredictedValue <- res>.5
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
dtest=dtest%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
dtest=dtest%>%
mutate(deck_risk=as.numeric(deck_risk=="Yes"))
dtest=dtest%>%
mutate(oe_constraint=as.numeric(oe_constraint=="Yes"))
dtest=dtest%>%
mutate(ppap_risk=as.numeric(ppap_risk=="Yes"))
dtest=dtest%>%
mutate(stop_auto_buy=as.numeric(stop_auto_buy=="Yes"))
dtest=dtest%>%
mutate(rev_stop=as.numeric(rev_stop=="Yes"))
dtest=dtest%>%
mutate(went_on_backorder=as.numeric(went_on_backorder=="Yes"))
sum(is.na(dtrain))
str(dtrain)
sum(is.na(dtest))
str(dtest)
res <- predict(fit, dtest, type = "response")
PredictedValue <- res>.5
pv <- as.numeric(PredictedValue)
head(pv)
table(pv)
View(dtest)
mydata = data.frame("sku"=dtest$sku,"went_on_backorder"=pv)
write.csv(mydata, file = "Prediction.csv")
train = read.csv('product_train.csv',stringsAsFactors = FALSE)
View(train)
sum(is.na(train))
table(dtrain$went_on_backorder)
table(train$went_on_backorder)
dtrain <- ovun.sample(went_on_backorder~., data=train,p=0.5, seed=1,method="over")$data
table(dtrain$went_on_backorder)
table(dtrain$potential_issue)
dtrain=dtrain%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
table(dtrain$potential_issue)
table(dtrain$deck_risk)
dtrain=dtrain%>%
mutate(deck_risk=as.numeric(deck_risk=="Yes"))
table(dtrain$oe_constraint)
dtrain=dtrain%>%
mutate(oe_constraint=as.numeric(oe_constraint=="Yes"))
table(dtrain$ppap_risk)
dtrain=dtrain%>%
mutate(ppap_risk=as.numeric(ppap_risk=="Yes"))
table(dtrain$stop_auto_buy)
dtrain=dtrain%>%
mutate(stop_auto_buy=as.numeric(stop_auto_buy=="Yes"))
table(dtrain$rev_stop)
dtrain=dtrain%>%
mutate(rev_stop=as.numeric(rev_stop=="Yes"))
table(dtrain$went_on_backorder)
dtrain=dtrain%>%
mutate(went_on_backorder=as.numeric(went_on_backorder=="Yes"))
View(dtrain)
sum(is.na(dtrain))
str(dtrain)
boxplot(dtrain$national_inv)
summary(dtrain$national_inv)
ul <- 22 + 1.5*(22 - 1)
dtrain$national_inv <- ifelse(dtrain$national_inv > ul, ul, dtrain$national_inv)
boxplot(dtrain$national_inv)
ll <- 1 - 1.5*(22-1)
dtrain$national_inv <- ifelse(dtrain$national_inv < ll, ll, dtrain$national_inv)
boxplot(dtrain$national_inv)
boxplot(dtrain$lead_time)
summary(dtrain$lead_time)
ul <- 8 + 1.5*(8 - 2)
dtrain$lead_time <- ifelse(dtrain$lead_time > ul, ul, dtrain$lead_time)
boxplot(dtrain$lead_time)
boxplot(dtrain$in_transit_qty)
summary(dtrain$in_transit_qty)
boxplot(dtrain$forecast_3_month)
summary(dtrain$forecast_3_month)
ul <- 24 + 1.5*(24 - 0)
dtrain$forecast_3_month <- ifelse(dtrain$forecast_3_month > ul, ul, dtrain$forecast_3_month)
boxplot(dtrain$forecast_3_month)
boxplot(dtrain$forecast_6_month)
summary(dtrain$forecast_6_month)
ul <- 42 + 1.5*(42 - 0)
dtrain$forecast_6_month <- ifelse(dtrain$forecast_6_month > ul, ul, dtrain$forecast_6_month)
boxplot(dtrain$forecast_6_month)
boxplot(dtrain$forecast_9_month)
summary(dtrain$forecast_9_month)
ul <- 60 + 1.5*(60 - 0)
dtrain$forecast_9_month <- ifelse(dtrain$forecast_9_month > ul, ul, dtrain$forecast_9_month)
boxplot(dtrain$forecast_9_month)
boxplot(dtrain$sales_1_month)
summary(dtrain$sales_1_month)
ul <- 7 + 1.5*(7 - 0)
dtrain$sales_1_month <- ifelse(dtrain$sales_1_month > ul, ul, dtrain$sales_1_month)
boxplot(dtrain$sales_1_month)
boxplot(dtrain$sales_3_month)
summary(dtrain$sales_3_month)
ul <- 21 + 1.5*(21 - 0)
dtrain$sales_3_month <- ifelse(dtrain$sales_3_month > ul, ul, dtrain$sales_3_month)
boxplot(dtrain$sales_3_month)
boxplot(dtrain$sales_6_month)
summary(dtrain$sales_6_month)
ul <- 38 + 1.5*(38 - 1)
dtrain$sales_6_month <- ifelse(dtrain$sales_6_month > ul, ul, dtrain$sales_6_month)
boxplot(dtrain$sales_6_month)
boxplot(dtrain$sales_9_month)
summary(dtrain$sales_9_month)
ul <- 55 + 1.5*(55 - 1)
dtrain$sales_9_month <- ifelse(dtrain$sales_9_month > ul, ul, dtrain$sales_9_month)
boxplot(dtrain$sales_9_month)
boxplot(dtrain$min_bank)
summary(dtrain$min_bank)
ul <- 3 + 1.5*(3 - 0)
dtrain$min_bank <- ifelse(dtrain$min_bank > ul, ul, dtrain$min_bank)
boxplot(dtrain$min_bank)
summary(for_vif)
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month
-pieces_past_due,data = dtrain)
summary(for_vif)
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month
= dtrain)
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month
,data = dtrain)
summary(for_vif)
for_vif <- lm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month-pieces_past_due
,data = dtrain)
summary(for_vif)
fit=glm(went_on_backorder~.-sales_6_month-forecast_6_month-sales_3_month-perf_12_month_avg-forecast_9_month-sales_9_month
-pieces_past_due-oe_constraint,family= "binomial",data = dtrain)
summary(fit)
fit=step(fit)
summary(fit)
formula(fit)
y_pred = predict(fit,newdata=dtrain,type="response")
ggplot(dtrain,aes(x=y_pred,y=went_on_backorder,color=factor(went_on_backorder)))+geom_point()+geom_jitter()
ROCRPred <- prediction(y_pred, dtrain$went_on_backorder)
ROCRPerf <- performance(ROCRPred, "tpr", "fpr")
plot(ROCRPerf, colorize=TRUE, print.cutoffs.at=seq(.1, by = 0.1))
abline(a=0, b=1)
res <- predict(fit, dtrain, type = "response")
PredictedValue <- res>.5
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
PredictedValue <- res>.4
pv <- as.numeric(PredictedValue)
pv <- as.factor(pv)
confusionMatrix(pv, dtrain$went_on_backorder)
PredictedValue <- res>.5
head(PredictedValue)
pv <- as.numeric(PredictedValue)
head(pv)
pv <- as.factor(pv)
dtrain$went_on_backorder <- as.factor(dtrain$went_on_backorder)
confusionMatrix(pv, dtrain$went_on_backorder)
dtest=dtest%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
dtest= read.csv('product_test.csv',stringsAsFactors = FALSE)
dtest=dtest%>%
mutate(potential_issue=as.numeric(potential_issue=="Yes"))
dtest=dtest%>%
mutate(deck_risk=as.numeric(deck_risk=="Yes"))
dtest=dtest%>%
mutate(oe_constraint=as.numeric(oe_constraint=="Yes"))
dtest=dtest%>%
mutate(ppap_risk=as.numeric(ppap_risk=="Yes"))
dtest=dtest%>%
mutate(stop_auto_buy=as.numeric(stop_auto_buy=="Yes"))
dtest=dtest%>%
mutate(rev_stop=as.numeric(rev_stop=="Yes"))
sum(is.na(dtest))
str(dtest)
res <- predict(fit, dtest, type = "response")
PredictedValue <- res>.5
pv <- as.numeric(PredictedValue)
head(pv)
table(pv)
mydata = data.frame("sku"=dtest$sku,"went_on_backorder"=pv)
install.packages(c("caret", "ggplot2", "ROCR", "ROSE"))
